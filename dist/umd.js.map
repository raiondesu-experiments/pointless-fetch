{"version":3,"file":"umd.js","sources":["../src/util.ts","../src/url.ts","../src/request.ts"],"sourcesContent":["export const join = (...parts: Array<string | undefined>) => parts\n  .filter(_ => _)\n  .join('/')\n  .replace(\n    /^(?:\\w+:\\/\\/)?(.*\\/+.+)/g,\n    (_, $1) => _.replace($1, $1.replace(/\\/+/g, '/'))\n  );\n\nexport const isBase = (url: string) => /^(\\w+:\\/\\/.+|\\/\\/)/.test(url);\n","import { join } from './util';\n\n/**\n * Creates a sub-url factory\n *\n * Example usage\n *\n * ```ts\n *  const myBlog = subUrl('https://my-blog.com');\n *  'https://my-blog.com'\n *\n *  const user = myBlog('user');\n *  'https://my-blog.com/user'\n *\n *  const userPost = user((id: number) => `${id}/post`);\n *  (id: number) => 'https://my-blog.com/user/${id}/post'\n * ```\n */\nexport const subUrl = function (\n  this: { base?: string },\n  url: string | ((...args: any[]) => string)\n) {\n  const applyBase = (\n    _url: (...args: any[]) => string\n  ) => (...args: any[]) => {\n    const concat = () => join(this ? this.base : undefined, _url(...args));\n\n    const _subUrl = subUrl.bind({ base: concat() });\n    _subUrl.toString = concat;\n\n    return _subUrl;\n  };\n\n  return typeof url === 'string'\n    ? applyBase(() => url)()\n    : applyBase(url);\n} as string & {\n  (base: string): typeof subUrl;\n\n  <F extends (...args: any[]) => string>(\n    base: F\n  ): (\n    ...args: Parameters<F>\n  ) => typeof subUrl;\n\n  toString(): string;\n};\n\nsubUrl.toString = () => '';\n\n/**\n * Encodes an object into the plain URL as url-query-string\n *\n * ```js\n *  query('/list', {\n *    amount: 5,\n *    filters: ['price', 'date']\n *  })\n * ```\n *\n * returns\n * ```js\n *  '/list?amount=5&filters=price,date'\n * ```\n *\n * @param url a url to encode params into\n * @param queryParams query params in object form\n * @returns url with encoded params\n */\nexport function query(url: string, queryParams: object) {\n  const query = Object.keys(queryParams)\n    .filter(k => k && queryParams[k] !== undefined)\n    .map((k): [string, string] => {\n      if (Array.isArray(queryParams[k])) {\n        return [queryParams[k].join(','), k];\n      } else if (typeof queryParams[k] === 'object') {\n        return [JSON.stringify(queryParams[k]), k];\n      }\n\n      return [queryParams[k], k];\n    })\n    .map(([value, key]) => `${encodeURIComponent(key)}=${encodeURI(value)}`)\n    .join('&');\n\n  const prefix = (url.indexOf('?') > -1 ? '&' : '?');\n\n  return url + (query.length > 0 ? prefix + query : '');\n}\n","import { join, isBase } from './util';\n\nexport type TRequest = RequestInit & { url: string };\n\nexport const request = ({ url, ...init }: TRequest) => new Request(url, init);\n\n/**\n * Combines two Request configs\n */\nexport const combine = (request: Request, addon: TRequest | Request) => new Request({\n  ...request,\n  url: isBase(addon.url) ? addon.url : join(request.url, addon.url),\n}, addon);\n"],"names":["join","parts","filter","_","replace","$1","subUrl","url","applyBase","_url","args","concat","_this","base","undefined","_subUrl","bind","toString","request","addon","Request","test","queryParams","query","Object","keys","k","map","Array","isArray","_typeof","JSON","stringify","value","key","encodeURIComponent","encodeURI","prefix","indexOf","length","init"],"mappings":"qxCAAO,IAAMA,EAAO,sCAAIC,2BAAAA,yBAAqCA,EAC1DC,OAAO,SAAAC,UAAKA,IACZH,KAAK,KACLI,QACC,2BACA,SAACD,EAAGE,UAAOF,EAAEC,QAAQC,EAAIA,EAAGD,QAAQ,OAAQ,SCanCE,EAAS,SAATA,EAEXC,cAEMC,EAAY,SAChBC,UACG,sCAAIC,2BAAAA,sBACDC,EAAS,kBAAMX,EAAKY,EAAOA,EAAKC,UAAOC,EAAWL,eAAQC,KAE1DK,EAAUT,EAAOU,KAAK,CAAEH,KAAMF,aACpCI,EAAQE,SAAWN,EAEZI,UAGa,iBAARR,EACVC,EAAU,kBAAMD,GAAhBC,GACAA,EAAUD,IAahBD,EAAOW,SAAW,iBAAM,cCvCD,SAACC,EAAkBC,UAA8B,IAAIC,yBACvEF,GACHX,KFHqBA,EEGTY,EAAMZ,IFHmB,qBAAqBc,KAAKd,GEGtCY,EAAMZ,IAAMP,EAAKkB,EAAQX,IAAKY,EAAMZ,QAC5DY,GFJmB,IAACZ,oBC6DDA,EAAae,OAC3BC,EAAQC,OAAOC,KAAKH,GACvBpB,OAAO,SAAAwB,UAAKA,QAAwBZ,IAAnBQ,EAAYI,KAC7BC,IAAI,SAACD,UACAE,MAAMC,QAAQP,EAAYI,IACrB,CAACJ,EAAYI,GAAG1B,KAAK,KAAM0B,GACC,WAA1BI,EAAOR,EAAYI,IACrB,CAACK,KAAKC,UAAUV,EAAYI,IAAKA,GAGnC,CAACJ,EAAYI,GAAIA,KAEzBC,IAAI,yBAAEM,OAAOC,uBAAYC,mBAAmBD,eAAQE,UAAUH,MAC9DjC,KAAK,KAEFqC,EAAU9B,EAAI+B,QAAQ,MAAQ,EAAI,IAAM,WAEvC/B,GAAOgB,EAAMgB,OAAS,EAAIF,EAASd,EAAQ,eClF7B,gBAAGhB,IAAAA,IAAQiC,sBAAqB,IAAIpB,QAAQb,EAAKiC"}